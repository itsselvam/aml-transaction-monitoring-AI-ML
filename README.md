# GRAPH-BASED TRANSACTION MONITORING USING MACHINE LEARNING TECHNIQUES

## Introduction
This project is an implementation of the Anti-money laundering in transaction monitoring process applying the proposal from the paper:
<pre><code>@article{elliott2019anomaly,
  title={Anomaly Detection in Networks with Application to Financial Transaction Networks},
  author={Elliott, Andrew and Cucuringu, Mihai and Luaces, Milton Martinez and Reidy, Paul and Reinert, Gesine},
  journal={arXiv preprint arXiv:1901.00402},
  year={2019}
}
</code></pre>

## Project structure and references to Open Sources projects
This implementation uses a number of the open source projects. The below list shows the ordered components, in which order the implementation is executed. 

### 1_Transaction_and_Feature_Generator
This component is used to generate simulated transaction network (graph) with embedded anomalies (suspicious nodes and topologies). This dataset is not only the simulated transaction data, but also the anomalous detection features from the transaction data are calculated. This means, the dataset used in the AML study is generated by this component. The simulation logics of the generation follow the suggestion from the paper stated in the above. The implementation of this component is taken from the open source GitHub repository at [Anomaly-Detection-in-Networks](https://github.com/zhangcheng1006/Anomaly-Detection-in-Networks.git). To run simulating the dataset, go into the directory and run the ordered processing steps in the Jupyter Notebook "1_Transaction_Simulator_and_Feature_Generator.ipynb"

### 2_Exploratory_Analysis.ipynb
This component explores the transaction data and its features, e.g. distribution of feature values between positive and negative labels. 

### 3_Model_Unsupervise_Feature_Sum.ipynb
This component implements the unsupervised "Feature Sum" approach based on the calculated anamalous detection features of the dataset. The implementation of this component follows the open source GitHub repository at [Anomaly-Detection-in-Networks](https://github.com/zhangcheng1006/Anomaly-Detection-in-Networks.git).

### 4_Model_Random_Forrest.ipynb
This is the supervised Random Forest model that is trained and tested on the simulated feature dataset. The implementation of this component follows the open source GitHub repository at [Anomaly-Detection-in-Networks](https://github.com/zhangcheng1006/Anomaly-Detection-in-Networks.git).

### 5_Model_Keras_Neural_Network.ipynb
This is another supervised Deep Learning classication model using Keras that is trained and tested on the simulated feature dataset. The implementation of this component follows the open source GitHub repository at [Classification on imbalanced data](https://www.tensorflow.org/tutorials/structured_data/imbalanced_data).

### 6_Model_Keras_NN_StellarGraph_Directed_Graphsage.ipynb
This supervised Deep Learning classification model is used as benchmark test. The dataset used in this model is the pure transaction dataset without the calculated anomalous detection features. The idea here is to compare the performance of the classication result on non-featured dataset to featured dataset. From this comparison, one can conclude how useful are the suggested feature calculations.

### 7_AML_ML_Application.ipynb
This implementation compares and combines all different models and the benchmark GraphSAGE model on another evaluation dataset (with calculated features). Confusion matrices are used to compare the results of different approaches. Finally, the transaction dataset with the true labels and predicted labels are persisted on Neo4j databased for the visualization analysis using Bloom visualization tool (on Neo4j Desktop). Please install the Enterprise version of Neo4j Desktop (free for one user) for this visualiation analysis.





